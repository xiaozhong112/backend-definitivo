<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>HoneySweeat - Admin | Productos</title>

  <!-- Bootstrap (CSS desde CDN no rompe tu CSP porque el problema era script-src) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- Bootstrap JS local para CSP estricta (si lo necesitas para colapsables/modals) -->
  <script src="vendor/bootstrap.bundle.min.js" defer></script>

  <!-- Boxicons -->
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet"/>

  <!-- Tu CSS de productos -->
  <link rel="stylesheet" href="F_Gestion_producto.css" />

  <style>
    body { background:#f9f4e5; margin:0; padding:0; }

    /* Navbar */
    .navbar-admin{ background:#4b2e00; }
    .navbar-admin .navbar-brand,.navbar-admin .navbar-text{ color:#ffc30b; }
    .navbar-admin .btn{ border-color:#ffc30b; color:#ffc30b; }
    .navbar-admin .btn:hover{ background:#ffc30b; color:#4b2e00; }

    /* Sidebar */
    .sidebar{ background:#fff; min-height:calc(100vh - 56px); box-shadow:0 0 10px rgba(0,0,0,.1); padding:0; }
    .sidebar-sticky{ position:sticky; top:56px; height:calc(100vh - 56px); padding-top:20px; overflow-y:auto; }
    .sidebar .nav-link{ color:#4b2e00; padding:12px 20px; border-bottom:1px solid #eee; display:flex; align-items:center; transition:.2s; }
    .sidebar .nav-link i{ margin-right:10px; font-size:18px; }
    .sidebar .nav-link:hover{ background:#ffe08a; color:#4b2e00; }
    .sidebar .nav-link.active{ background:#ffc30b !important; color:#4b2e00 !important; font-weight:bold; }

    /* Contenido principal */
    .main-content{ padding:20px; }

    /* Cards estilo admin (compatibles con tu CSS existente) */
    .card-admin{ background:#fff; border-radius:15px; overflow:hidden; box-shadow:0 6px 15px rgba(0,0,0,.15); border:none; margin-bottom:20px; }
    .card-header-admin{ background:#ffc30b; color:#4b2e00; padding:15px 20px; font-weight:bold; display:flex; align-items:center; justify-content:space-between; }
    .card-body-admin{ padding:20px; }

    /* Alertas compatibles con tu JS */
    .alert{ display:none; border-radius:10px; margin-bottom:12px; padding:10px 14px; }
    .alert.show{ display:block; }
    .alert.ok{ background:#e6ffed; color:#127c35; border:1px solid #7ee2a8; }
    .alert.err{ background:#ffecec; color:#b00020; border:1px solid #ff9aa2; }

    /* Botones fantasma para encabezados */
    .btn.ghost{ background:transparent; border:1px solid #4b2e00; color:#4b2e00; }
    .btn.ghost:hover{ background:#4b2e00; color:#ffc30b; }
    .btn.small{ padding:6px 10px; font-size:.9rem; }
    .btn.primary{ background:#28a745; color:#fff; border:none; }
    .btn.primary:hover{ filter:brightness(0.95); }
    .btn.danger{ background:#dc3545; color:#fff; border:none; }

    .actions-col{ white-space:nowrap; }

    /* Ajustes mínimos para la tabla de productos dentro del layout admin */
    .table-wrap{ background:#fff; border-radius:15px; box-shadow:0 6px 15px rgba(0,0,0,.15); padding:10px; }
  </style>
</head>

<!-- Marca activo el menú -->
<body data-page="products">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-sm navbar-admin">
    <div class="container-fluid">
      <a class="navbar-brand" href="Frontend.html">HoneySweeat - Admin</a>
      <div class="ms-auto">
        <span class="navbar-text me-3">Administrador</span>
        <button class="btn btn-sm" id="logoutBtn">Cerrar Sesión</button>
      </div>
    </div>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <aside class="col-md-3 col-lg-2 sidebar">
        <div class="sidebar-sticky">
          <ul class="nav flex-column">
            <li class="nav-item">
              <a class="nav-link" href="F_Loging_Admin.html" data-link="dashboard">
                <i class='bx bxs-dashboard'></i> Dashboard
              </a>
            </li>
            <li class="nav-item">
              <!-- Activo aquí -->
              <a class="nav-link active" href="F_Gestion_producto.html" data-link="products">
                <i class='bx bxs-package'></i> Productos
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="F_Admin_usuarios.html" data-link="users">
                <i class='bx bxs-user'></i> Usuarios
              </a>
            </li>
          </ul>
        </div>
      </aside>

      <!-- Main -->
      <main class="col-md-9 col-lg-10 main-content">

        <!-- Alerts -->
        <div id="alertOk" class="alert ok" role="alert"></div>
        <div id="alertErr" class="alert err" role="alert"></div>

        <!-- FORMULARIO: Crear/Editar Producto -->
        <section class="card-admin">
          <div class="card-header-admin">
            <h5 id="formTitle"><i class='bx bx-plus-circle'></i> Nuevo producto</h5>
            <div>
              <button id="btnCancelEdit" class="btn btn-sm btn-secondary me-2 hidden">
                <i class='bx bx-x-circle'></i> Cancelar edición
              </button>
              <button id="btnReset" class="btn btn-sm btn-outline-dark">
                <i class='bx bx-reset'></i> Limpiar
              </button>
            </div>
          </div>

          <div class="card-body-admin">
            <!-- Tu form original (con IDs intactos) -->
            <form id="productForm" class="grid">
              <input type="hidden" id="editingId" value="" />

              <div class="field">
                <label for="name">Nombre</label>
                <input id="name" type="text" placeholder="Miel de Ulmo" required />
              </div>

              <div class="field">
                <label for="floralSource">Origen floral</label>
                <select id="floralSource" required>
                  <option value="ulmo">Ulmo</option>
                  <option value="quillay">Quillay</option>
                  <option value="multiflora" selected>Multiflora</option>
                  <option value="eucalipto">Eucalipto</option>
                  <option value="otras">Otras</option>
                </select>
              </div>

              <div class="field wide">
                <label for="description">Descripción</label>
                <textarea id="description" rows="2" placeholder="Miel 100% natural, cosecha 2025..."></textarea>
              </div>

              <div class="field wide">
                <label for="imageUrl">Imagen (URL)</label>
                <input id="imageUrl" type="url" placeholder="https://..." />
              </div>

              <div class="field">
                <label class="checkbox">
                  <input type="checkbox" id="isActive" checked />
                  Activo
                </label>
              </div>

              <!-- Variantes -->
              <div class="variants-block wide">
                <div class="variants-header">
                  <h3><i class='bx bx-collection'></i> Variantes</h3>
                  <button type="button" id="btnAddVar" class="btn small">
                    <i class='bx bx-plus'></i> Agregar variante
                  </button>
                </div>

                <div class="variants-grid" id="variantsGrid">
                  <!-- filas de variantes dinámicas -->
                </div>
              </div>

              <div class="actions wide">
                <button type="submit" id="btnSave" class="btn primary">
                  <i class='bx bx-save'></i> Guardar
                </button>
                <button type="button" id="btnCancelEdit" class="btn danger hidden">
                  <i class='bx bx-x-circle'></i> Cancelar edición
                </button>
              </div>
            </form>
          </div>
        </section>

        <!-- LISTA: Productos -->
        <section class="card-admin">
          <div class="card-header-admin">
            <h5 id="productsTitle"><i class='bx bx-list-ul'></i> Productos (solo activos)</h5>
            <div>
              <button id="btnToggleView" class="btn btn-sm btn-outline-dark">
                <i class='bx bx-hide'></i> Ver inactivos
              </button>
              <button id="btnReload" class="btn btn-sm btn-outline-dark ms-2">
                <i class='bx bx-refresh'></i> Recargar
              </button>
            </div>
          </div>

          <div class="card-body-admin">
            <div class="table-wrap">
              <table class="table">
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Origen</th>
                    <th>Variantes</th>
                    <th>Estado</th>
                    <th class="actions-col">Acciones</th>
                  </tr>
                </thead>
                <tbody id="productsBody">
                  <!-- filas dinámicas -->
                </tbody>
              </table>
            </div>
          </div>
        </section>

      </main>
    </div>
  </div>

  <!-- Scripts -->
  <script src="js/admin.js" defer></script>
  <script src="js/gestionProducto.js" defer></script>
</body>
</html>
